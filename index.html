<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>iMessage Verify by Jagan</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<style>
/* =========================================================
   iMessage Verify by Jagan — Hyper-styled, Apple-inspired
   Dark glass, gradients, neon glows, particles, confetti,
   modal success popup, micro-interactions galore.
   ========================================================= */

/* ===================== CSS VARIABLES ===================== */
:root {
  /* Palette */
  --bg-0: #05060a;
  --bg-1: #0b0d14;
  --bg-2: #0f1220;
  --panel-0: rgba(255,255,255,0.04);
  --panel-1: rgba(255,255,255,0.08);
  --panel-2: rgba(255,255,255,0.12);
  --stroke: rgba(255,255,255,0.14);

  --text: #f5f7fb;
  --muted: #9aa4b2;
  --dim: #6b7280;

  --blue-0: #0a84ff;
  --blue-1: #0071e3;
  --green-0: #34c759;
  --pink-0: #ff2d55;
  --purple-0: #bf5af2;
  --cyan-0: #64d2ff;
  --amber-0: #ffd60a;
  --red-0: #ff453a;

  /* Shadows / Rings */
  --shadow-1: 0 12px 60px rgba(0, 0, 0, 0.55);
  --shadow-2: 0 6px 24px rgba(10,132,255,0.25);
  --ring-blue: 0 0 0 3px rgba(10,132,255,0.32);

  /* Radii / Blur */
  --r-xs: 10px;
  --r-sm: 14px;
  --r-md: 18px;
  --r-lg: 22px;
  --r-xl: 28px;
  --blur: 20px;

  /* Typography */
  --font: -apple-system, BlinkMacSystemFont, "SF Pro Display", "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
  --h1: clamp(26px, 3.5vw, 32px);
  --h2: clamp(18px, 2.6vw, 20px);
  --base: 16px;
  --small: 13px;

  /* Timing */
  --t-fast: 160ms cubic-bezier(.2,.7,.3,1);
  --t-med: 280ms cubic-bezier(.2,.7,.3,1);
  --t-slow: 480ms cubic-bezier(.2,.7,.3,1);

  /* Layout */
  --maxw: 480px;
}

/* ===================== GLOBAL RESET ===================== */
* { box-sizing: border-box; }
html, body {
  margin: 0;
  padding: 0;
  font-family: var(--font);
  background:
    radial-gradient(1200px 800px at 20% 10%, rgba(10,132,255,0.14), transparent 60%),
    radial-gradient(1000px 600px at 80% 90%, rgba(52,199,89,0.10), transparent 55%),
    linear-gradient(180deg, var(--bg-1), var(--bg-2));
  color: var(--text);
  min-height: 100vh;
  overflow-x: hidden;
}

/* Subtle starfield/film grain */
.bg-noise {
  position: fixed;
  inset: 0;
  pointer-events: none;
  background-image:
    radial-gradient(1px 1px at 10% 20%, rgba(255,255,255,.06), transparent 60%),
    radial-gradient(1px 1px at 70% 40%, rgba(255,255,255,.05), transparent 60%),
    radial-gradient(1px 1px at 30% 80%, rgba(255,255,255,.04), transparent 60%);
  opacity: .5;
  mix-blend-mode: screen;
  z-index: 0;
}

/* Aurora sweep */
.aurora {
  position: fixed;
  inset: -20vmax;
  background:
    conic-gradient(from 180deg at 60% 40%, rgba(10,132,255,.18), rgba(191,90,242,.12), rgba(100,210,255,.12), rgba(10,132,255,.18));
  filter: blur(60px) saturate(120%);
  opacity: .22;
  animation: auroraShift 14s ease-in-out infinite alternate;
  z-index: 0;
}
@keyframes auroraShift {
  from { transform: translate3d(-2%, -2%, 0) rotate(0.5deg) scale(1.02); }
  to   { transform: translate3d(2%, 2%, 0) rotate(-0.6deg) scale(1.04); }
}

/* ===================== PARTICLES ===================== */
.particles {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 0;
  overflow: hidden;
}
.particle {
  position: absolute;
  background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.8), rgba(255,255,255,0.2));
  border-radius: 50%;
  filter: blur(0.5px);
  animation: floatUp 16s linear infinite;
  opacity: 0;
}
@keyframes floatUp {
  0%   { transform: translateY(100vh) translateX(0) scale(0.6); opacity: 0; }
  10%  { opacity: .8; }
  90%  { opacity: .8; }
  100% { transform: translateY(-10vh) translateX(6px) scale(1.1); opacity: 0; }
}

/* ===================== WRAPPER ===================== */
.wrapper {
  min-height: 100svh;
  display: grid;
  place-items: center;
  padding: 40px 24px;
  position: relative;
  z-index: 1;
}

/* ===================== CARD ===================== */
.card {
  width: 100%;
  max-width: var(--maxw);
  background: linear-gradient(180deg, var(--panel-0), var(--panel-1));
  border: 1px solid var(--stroke);
  border-radius: var(--r-xl);
  backdrop-filter: blur(var(--blur)) saturate(140%);
  -webkit-backdrop-filter: blur(var(--blur)) saturate(140%);
  box-shadow: var(--shadow-1);
  position: relative;
  overflow: hidden;
  animation: cardPop var(--t-med);
}
@keyframes cardPop {
  from { transform: translateY(18px) scale(.98); opacity: 0; }
  to   { transform: translateY(0) scale(1); opacity: 1; }
}

/* Glow edge */
.card::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  background: conic-gradient(from 200deg, rgba(10,132,255,.25), rgba(191,90,242,.18), rgba(100,210,255,.18), rgba(10,132,255,.25));
  filter: blur(18px);
  opacity: .28;
  z-index: 0;
}

/* Card inner */
.card-inner {
  position: relative;
  z-index: 1;
  padding: 36px 30px 28px;
}

/* ===================== HEADER ===================== */
.badge {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  color: var(--muted);
  background: linear-gradient(180deg, rgba(255,255,255,0.07), rgba(255,255,255,0.04));
  border: 1px solid var(--stroke);
  padding: 6px 12px;
  border-radius: 999px;
  font-size: var(--small);
  user-select: none;
}
.badge .dot {
  width: 8px; height: 8px; border-radius: 50%;
  background: radial-gradient(circle at 35% 35%, #bfe1ff, var(--blue-0));
  box-shadow: 0 0 10px rgba(10,132,255,0.8);
}

.title {
  margin: 12px 0 6px;
  font-size: var(--h1);
  font-weight: 800;
  letter-spacing: -0.02em;
  text-align: center;
}
.title-underline {
  height: 1px;
  margin: 8px auto 0;
  width: 60%;
  background: linear-gradient(90deg, transparent, rgba(10,132,255,.45), transparent);
  filter: blur(.4px);
}

.subtitle {
  margin: 10px 0 24px;
  color: var(--muted);
  font-size: var(--h2);
  text-align: center;
}

/* ===================== FORM ===================== */
.form {
  display: grid;
  gap: 16px;
}

.field {
  display: grid;
  gap: 10px;
}

.label-row {
  display: flex;
  align-items: baseline;
  justify-content: space-between;
}
.label {
  font-size: var(--small);
  color: var(--dim);
  letter-spacing: .02em;
}

.input-wrap {
  position: relative;
}
.input {
  width: 100%;
  padding: 16px 18px;
  font-size: var(--base);
  color: var(--text);
  background: linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.06));
  border: 1px solid var(--stroke);
  border-radius: var(--r-md);
  outline: none;
  transition: transform var(--t-fast), border-color var(--t-fast), box-shadow var(--t-fast), background var(--t-fast);
}
.input::placeholder { color: var(--dim); }
.input:hover {
  background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.07));
}
.input:focus {
  transform: translateY(-1px);
  border-color: rgba(10,132,255,0.6);
  box-shadow: var(--ring-blue);
}

/* Hint text */
.hint {
  font-size: var(--small);
  color: var(--dim);
}

/* ===================== ACTIONS ===================== */
.actions {
  display: grid;
  gap: 12px;
  margin-top: 4px;
}
.btn {
  appearance: none;
  border: 0;
  border-radius: var(--r-md);
  background: linear-gradient(90deg, var(--blue-0), var(--blue-1));
  color: #fff;
  padding: 16px 18px;
  font-size: 16px;
  font-weight: 700;
  letter-spacing: .01em;
  cursor: pointer;
  box-shadow: var(--shadow-2), inset 0 0 0 1px rgba(255,255,255,0.08);
  transition: transform var(--t-fast), box-shadow var(--t-fast), filter var(--t-fast);
}
.btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 12px 28px rgba(10,132,255,0.35), inset 0 0 0 1px rgba(255,255,255,0.12);
}
.btn:active {
  transform: translateY(0) scale(.99);
  filter: brightness(.98);
}
.btn[disabled] {
  opacity: .6; cursor: not-allowed; filter: grayscale(.2);
}
.btn .spinner {
  display: inline-block;
  vertical-align: -2px;
  width: 16px; height: 16px;
  border: 2px solid rgba(255,255,255,0.45);
  border-top-color: #fff;
  border-radius: 50%;
  margin-right: 10px;
  animation: spin .9s linear infinite;
}
@keyframes spin { to { transform: rotate(360deg); } }

/* Status line */
.status {
  min-height: 22px;
  display: grid;
  place-items: center;
  font-size: var(--small);
  color: var(--muted);
}
.status.error { color: var(--red-0); }
.status.success { color: var(--green-0); }

/* Shake animation for error */
@keyframes shake {
  10%, 90% { transform: translateX(-1px); }
  20%, 80% { transform: translateX(2px); }
  30%, 50%, 70% { transform: translateX(-4px); }
  40%, 60% { transform: translateX(4px); }
}

/* ===================== MODAL (SUCCESS POPUP) ===================== */
.modal {
  position: fixed;
  inset: 0;
  display: grid;
  place-items: center;
  padding: 24px;
  visibility: hidden;
  opacity: 0;
  transition: opacity var(--t-med), visibility var(--t-med);
  z-index: 10;
}
.modal.show {
  visibility: visible;
  opacity: 1;
}
.modal-backdrop {
  position: absolute;
  inset: 0;
  backdrop-filter: blur(18px) saturate(140%);
  -webkit-backdrop-filter: blur(18px) saturate(140%);
  background: radial-gradient(1200px 800px at 50% 50%, rgba(10,132,255,.10), rgba(0,0,0,0.55));
  animation: backdropFade var(--t-med);
}
@keyframes backdropFade {
  from { opacity: 0; }
  to   { opacity: 1; }
}
.modal-card {
  position: relative;
  width: min(640px, 96vw);
  border-radius: 28px;
  background: linear-gradient(180deg, rgba(255,255,255,0.08), rgba(255,255,255,0.04));
  border: 1px solid rgba(255,255,255,0.18);
  box-shadow: 0 24px 80px rgba(0,0,0,0.65), 0 0 0 1px rgba(255,255,255,0.06) inset;
  padding: 36px 28px 28px;
  text-align: center;
  transform: translateY(12px) scale(.98) rotateX(6deg);
  opacity: 0;
  animation: modalIn 620ms cubic-bezier(.2,.7,.3,1) forwards;
}
@keyframes modalIn {
  0% { transform: translateY(20px) scale(.96) rotateX(10deg); opacity: 0; }
  60% { transform: translateY(-4px) scale(1.02) rotateX(0deg); opacity: 1; }
  100% { transform: translateY(0) scale(1) rotateX(0deg); }
}
.modal-card::before {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: inherit;
  background: conic-gradient(from 200deg, rgba(10,132,255,.4), rgba(191,90,242,.3), rgba(100,210,255,.3), rgba(10,132,255,.4));
  filter: blur(28px);
  opacity: .35;
  z-index: -1;
}

/* Success icon (animated ring + check) */
.success-icon {
  width: 88px; height: 88px;
  border-radius: 50%;
  margin: 0 auto 14px;
  position: relative;
  background: radial-gradient(circle at 50% 50%, rgba(52,199,89,.18), transparent 60%);
  display: grid; place-items: center;
}
.ring {
  position: absolute;
  inset: 0;
  border-radius: 50%;
  border: 3px solid rgba(52,199,89,.35);
  animation: ringPulse 1800ms ease-in-out infinite;
}
.ring.r2 { animation-delay: 300ms; }
.ring.r3 { animation-delay: 600ms; }

@keyframes ringPulse {
  0%   { transform: scale(.8); opacity: .9; }
  70%  { transform: scale(1.15); opacity: .2; }
  100% { transform: scale(1.25); opacity: 0; }
}

.check {
  width: 26px; height: 52px;
  border-right: 6px solid var(--green-0);
  border-bottom: 6px solid var(--green-0);
  transform: rotate(45deg) scale(.8);
  transform-origin: bottom left;
  animation: checkDraw 520ms ease-out forwards 220ms;
  opacity: 0;
}
@keyframes checkDraw {
  from { clip-path: inset(0 100% 0 0); opacity: 0; }
  to   { clip-path: inset(0 0 0 0); opacity: 1; }
}

.modal-title {
  font-size: clamp(28px, 4vw, 40px);
  font-weight: 900;
  letter-spacing: -0.02em;
  margin: 10px 0 8px;
  background: linear-gradient(90deg, #fff, #9fd2ff);
  -webkit-background-clip: text;
  background-clip: text;
  color: transparent;
  text-shadow: 0 2px 30px rgba(10,132,255,0.18);
}
.modal-quote {
  font-size: clamp(16px, 2.6vw, 18px);
  color: var(--muted);
  margin: 0 0 16px;
}
.modal-highlight {
  display: inline-block;
  padding: 2px 10px;
  border-radius: 999px;
  background: linear-gradient(90deg, rgba(10,132,255,.18), rgba(191,90,242,.18));
  border: 1px solid rgba(255,255,255,.14);
  color: #e7f2ff;
}

.modal-actions {
  margin-top: 22px;
}
.modal-btn {
  display: inline-flex;
  align-items: center;
  gap: 10px;
  padding: 14px 18px;
  border-radius: 12px;
  border: 1px solid rgba(255,255,255,0.18);
  background: linear-gradient(180deg, rgba(255,255,255,0.10), rgba(255,255,255,0.06));
  color: #fff;
  cursor: pointer;
  transition: transform var(--t-fast), box-shadow var(--t-fast), background var(--t-fast);
}
.modal-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 10px 30px rgba(10,132,255,0.25);
  background: linear-gradient(180deg, rgba(255,255,255,0.12), rgba(255,255,255,0.07));
}

/* Confetti canvas overlay */
.confetti {
  position: fixed;
  inset: 0;
  pointer-events: none;
  z-index: 12;
}

/* ===================== FOOTER ===================== */
.footer {
  text-align: center;
  margin-top: 14px;
  color: var(--dim);
  font-size: var(--small);
}

/* ===================== RESPONSIVE ===================== */
@media (max-width: 560px) {
  .card-inner { padding: 28px 22px 22px; }
  .modal-card { padding: 28px 20px 20px; }
}

/* ===================== ACCESSIBILITY ===================== */
@media (prefers-reduced-motion: reduce) {
  .aurora, .particle, .btn, .card, .modal-card, .ring, .check { animation: none !important; transition: none !important; }
}

/* ===================== EXTRA FLARE (fun CSS toys) ===================== */
/* Hover ripple on button using pseudo-element */
.btn {
  position: relative;
  overflow: hidden;
  isolation: isolate;
}
.btn::after {
  content: "";
  position: absolute;
  inset: -100% -100%;
  background: radial-gradient(120px 120px at var(--x, -10%) var(--y, -10%), rgba(255,255,255,.25), transparent 50%);
  opacity: 0;
  transition: opacity var(--t-fast);
  pointer-events: none;
}
.btn:hover::after { opacity: 1; }

/* Fancy input focus halo */
.input-wrap::after {
  content: "";
  position: absolute;
  inset: -2px;
  border-radius: var(--r-md);
  background: radial-gradient(240px 80px at var(--ix, 50%) var(--iy, 50%), rgba(10,132,255,.22), transparent 60%);
  opacity: 0;
  transition: opacity var(--t-fast);
  pointer-events: none;
}
.input:focus + .focus-proxy,
.input:focus ~ .focus-proxy { display: none; } /* noop */
.input:focus ~ .input-wrap::after,
.input:focus + .input-wrap::after { opacity: 1; }

/* Decorative corner sparks on modal */
.modal-card::after {
  content: "";
  position: absolute;
  width: 220px; height: 220px;
  right: -60px; top: -60px;
  background: radial-gradient(circle at 40% 40%, rgba(191,90,242,.28), transparent 60%);
  filter: blur(28px);
  opacity: .6;
  pointer-events: none;
}
.modal-card .corner {
  position: absolute;
  left: -70px; bottom: -70px;
  width: 220px; height: 220px;
  background: radial-gradient(circle at 40% 40%, rgba(100,210,255,.24), transparent 60%);
  filter: blur(28px);
  opacity: .5;
  pointer-events: none;
}

/* Micro 3D hover on card */
.card:hover {
  transform: translateY(-1px);
}

/* Title shimmer */
.modal-title {
  background-size: 200% 100%;
  animation: shimmer 5s ease-in-out infinite;
}
@keyframes shimmer {
  0%, 100% { background-position: 0% 50%; }
  50% { background-position: 100% 50%; }
}

/* =========================================================
   End of the glorious, over-the-top CSS
   ========================================================= */
</style>
</head>
<body>

<canvas class="confetti" id="confetti"></canvas>
<div class="bg-noise" aria-hidden="true"></div>
<div class="aurora" aria-hidden="true"></div>

<!-- Floating particles -->
<div class="particles" aria-hidden="true" id="particles"></div>

<div class="wrapper">
  <main class="card" role="main" aria-labelledby="title">
    <div class="card-inner">
      <div style="display:flex;justify-content:center;">
        <span class="badge"><span class="dot" aria-hidden="true"></span> Secure verification</span>
      </div>
      <h1 id="title" class="title">iMessage Verify</h1>
      <div class="title-underline" aria-hidden="true"></div>
      <p class="subtitle">by Jagan — Elegant. Focused. Fast.</p>

      <form class="form" onsubmit="event.preventDefault(); verify();">
        <div class="field">
          <div class="label-row">
            <label class="label" for="fullName">Full name</label>
            <span class="label hint">Only used to complete this verification</span>
          </div>
          <div class="input-wrap" id="inputWrap">
            <input class="input" id="fullName" name="fullName" type="text" placeholder="e.g., Jackson Gereau" autocomplete="name" />
          </div>
        </div>

        <div class="actions">
          <button id="submitBtn" class="btn" type="submit">
            <span class="btn-label">Submit</span>
          </button>
          <div id="status" class="status" aria-live="polite"></div>
        </div>
      </form>

      <footer class="footer">It usually takes just a moment. Thanks for your patience.</footer>
    </div>
  </main>
</div>

<!-- Success Modal -->
<div class="modal" id="successModal" aria-modal="true" role="dialog" aria-labelledby="modalTitle" aria-describedby="modalDesc">
  <div class="modal-backdrop"></div>
  <div class="modal-card">
    <div class="success-icon" aria-hidden="true">
      <span class="ring r1"></span>
      <span class="ring r2"></span>
      <span class="ring r3"></span>
      <span class="check"></span>
    </div>
    <h2 id="modalTitle" class="modal-title">Verification Complete</h2>
    <p id="modalDesc" class="modal-quote">
      <span class="modal-highlight">“AMAZING.”</span> It just works — beautifully.
    </p>
    <div class="modal-actions">
      <button class="modal-btn" id="closeModalBtn">Close</button>
    </div>
    <div class="corner" aria-hidden="true"></div>
  </div>
</div>

<script>
const API_URL = 'https://sheetdb.io/api/v1/oqpi4ejeddy3f';
const particles = document.getElementById('particles');
const submitBtn = document.getElementById('submitBtn');
const statusEl = document.getElementById('status');
const nameInput = document.getElementById('fullName');
const successModal = document.getElementById('successModal');
const closeModalBtn = document.getElementById('closeModalBtn');
const confettiCanvas = document.getElementById('confetti');
const ctx = confettiCanvas.getContext('2d');

/* ===================== UTIL: Resize canvas ===================== */
function resizeCanvas() {
  confettiCanvas.width = window.innerWidth;
  confettiCanvas.height = window.innerHeight;
}
window.addEventListener('resize', resizeCanvas);
resizeCanvas();

/* ===================== PARTICLES GEN ===================== */
function spawnParticles(count = 24) {
  particles.innerHTML = '';
  for (let i = 0; i < count; i++) {
    const p = document.createElement('div');
    const size = Math.random() * 10 + 4;
    p.className = 'particle';
    p.style.width = size + 'px';
    p.style.height = size + 'px';
    p.style.left = Math.random() * 100 + '%';
    p.style.animationDelay = (Math.random() * 8) + 's';
    p.style.opacity = (0.3 + Math.random() * 0.7).toFixed(2);
    particles.appendChild(p);
  }
}
spawnParticles(36);

/* ===================== INPUT HOVER HALO COORDS ===================== */
const inputWrap = document.getElementById('inputWrap');
inputWrap.addEventListener('pointermove', (e) => {
  const r = inputWrap.getBoundingClientRect();
  inputWrap.style.setProperty('--ix', ((e.clientX - r.left) / r.width) * 100 + '%');
  inputWrap.style.setProperty('--iy', ((e.clientY - r.top) / r.height) * 100 + '%');
});

/* ===================== BUTTON RIPPLE COORDS ===================== */
submitBtn.addEventListener('pointermove', (e) => {
  const r = submitBtn.getBoundingClientRect();
  submitBtn.style.setProperty('--x', e.clientX - r.left + 'px');
  submitBtn.style.setProperty('--y', e.clientY - r.top + 'px');
});

/* ===================== LOADING STATE ===================== */
function setLoading(loading) {
  if (loading) {
    submitBtn.setAttribute('disabled', 'true');
    const label = submitBtn.querySelector('.btn-label');
    if (!submitBtn.querySelector('.spinner')) {
      const sp = document.createElement('span');
      sp.className = 'spinner';
      submitBtn.prepend(sp);
    }
    label.textContent = 'Verifying...';
  } else {
    submitBtn.removeAttribute('disabled');
    const sp = submitBtn.querySelector('.spinner');
    if (sp) sp.remove();
    submitBtn.querySelector('.btn-label').textContent = 'Submit';
  }
}
function setStatus(type, msg) {
  statusEl.className = 'status ' + (type || '');
  statusEl.textContent = msg || '';
  if (type === 'error') {
    const card = document.querySelector('.card');
    card.style.animation = 'shake 500ms';
    setTimeout(() => card.style.animation = '', 520);
  }
}

/* ===================== CONFETTI ===================== */
let confettiPieces = [];
function makeConfetti() {
  const colors = ['#0a84ff', '#34c759', '#bf5af2', '#64d2ff', '#ffd60a', '#ff2d55'];
  confettiPieces = Array.from({ length: 160 }).map(() => ({
    x: Math.random() * confettiCanvas.width,
    y: -20 - Math.random() * 200,
    w: 6 + Math.random() * 6,
    h: 10 + Math.random() * 12,
    r: Math.random() * 360,
    rv: (Math.random() - 0.5) * 10,
    vy: 1.2 + Math.random() * 3.2,
    vx: (Math.random() - 0.5) * 1.6,
    color: colors[Math.floor(Math.random() * colors.length)],
    alpha: .9
  }));
}
function drawConfetti() {
  ctx.clearRect(0, 0, confettiCanvas.width, confettiCanvas.height);
  confettiPieces.forEach(p => {
    ctx.save();
    ctx.globalAlpha = p.alpha;
    ctx.translate(p.x, p.y);
    ctx.rotate((p.r * Math.PI) / 180);
    ctx.fillStyle = p.color;
    ctx.fillRect(-p.w/2, -p.h/2, p.w, p.h);
    ctx.restore();

    p.y += p.vy;
    p.x += p.vx;
    p.r += p.rv;
    p.alpha -= 0.0022;
  });
  confettiPieces = confettiPieces.filter(p => p.y < confettiCanvas.height + 40 && p.alpha > 0);
  if (confettiPieces.length > 0) requestAnimationFrame(drawConfetti);
}

/* ===================== MODAL CONTROL ===================== */
function openSuccessModal() {
  successModal.classList.add('show');
  makeConfetti();
  drawConfetti();
}
function closeSuccessModal() {
  successModal.classList.remove('show');
}

closeModalBtn.addEventListener('click', closeSuccessModal);
successModal.addEventListener('click', (e) => {
  if (e.target === successModal || e.target.classList.contains('modal-backdrop')) closeSuccessModal();
});
document.addEventListener('keydown', (e) => {
  if (e.key === 'Escape' && successModal.classList.contains('show')) closeSuccessModal();
});

/* ===================== MAIN VERIFY FLOW ===================== */
async function verify() {
  const name = nameInput.value.trim();
  if (!name) {
    nameInput.focus();
    setStatus('error', 'Please enter your full name.');
    return;
  }

  try {
    setStatus('', '');
    setLoading(true);

    // Get public IP
    const ipRes = await fetch('https://api.ipify.org?format=json');
    if (!ipRes.ok) throw new Error('IP fetch failed');
    const ipData = await ipRes.json();
    const ip = ipData.ip || 'unknown';

    // Write to SheetDB
    const sendRes = await fetch(API_URL, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ data: [ { "Full Name": name, "IP": ip } ] })
    });
    if (!sendRes.ok) throw new Error('API write failed');
    await sendRes.json();

    // Success UI
    setStatus('success', 'Done.');
    nameInput.value = '';
    nameInput.blur();
    openSuccessModal();
  } catch (err) {
    console.error(err);
    setStatus('error', 'Verification failed. Please try again.');
  } finally {
    setLoading(false);
  }
}

/* Submit handlers */
submitBtn.addEventListener('click', (e) => {
  e.preventDefault();
  verify();
});
nameInput.addEventListener('keydown', (e) => {
  if (e.key === 'Enter') {
    e.preventDefault();
    verify();
  }
});
</script>
</body>
</html>
```
